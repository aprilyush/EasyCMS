/* @preserve
 * gcoord 0.1.2, geographic coordinate library
 * Copyright (c) 2018 Jiulong Hu <me@hujiulong.com>
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(t.gcoord={})}(this,function(t){"use strict";var r="WGS84",e=r,n="GCJ02",o="BD09",i=r,a="EPSG3857",u=a,l=o,f=o,s=n,c=a;function y(t,r){if(t)throw new Error(r)}function d(t){return!isNaN(t)&&null!==t&&!v(t)}function v(t){return!!t&&"[object Array]"===Object.prototype.toString.call(t)}function h(){var t=arguments,r=t.length-1;return function(){for(var e=r,n=t[r].apply(this,arguments);e--;)n=t[e].call(this,n);return n}}var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b=function(){return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,r){var e=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(e.push(a.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return e}(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=Math.sin,p=Math.cos,S=Math.sqrt,M=Math.abs,G=Math.PI,P=6378245,E=.006693421622965823;function B(t){var r=b(t,2),e=r[0],n=r[1];if(!C(e,n))return[e,n];for(var o=e,i=n,a=W([o,i]),u=a[0]-e,l=a[1]-n;M(u)>1e-6||M(l)>1e-6;)u=(a=W([o-=u,i-=l]))[0]-e,l=a[1]-n;return[o,i]}function W(t){var r=b(t,2),e=r[0],n=r[1];if(!C(e,n))return[e,n];var o,i,a,u,l,f,s,c,y,d,v,h,g,B=(g=300+(v=(o=e)-105)+2*(h=(i=n)-35)+.1*v*v+.1*v*h+.1*S(M(v)),g+=2*(20*m(6*v*G)+20*m(2*v*G))/3,g+=2*(20*m(v*G)+40*m(v/3*G))/3,a=g+=2*(150*m(v/12*G)+300*m(v/30*G))/3,d=2*(c=o-105)-100+3*(y=i-35)+.2*y*y+.1*c*y+.2*S(M(c)),d+=2*(20*m(6*c*G)+20*m(2*c*G))/3,d+=2*(20*m(y*G)+40*m(y/3*G))/3,u=d+=2*(160*m(y/12*G)+320*m(y*G/30))/3,f=m(l=i/180*G),s=S(f=1-E*f*f),[a=180*a/(P/s*p(l)*G),u=180*u/(P*(1-E)/(f*s)*G)]);return[e+B[0],n+B[1]]}function C(t,r){return y(void 0===t||void 0===r,"lon and lat are required"),y(!d(t)||!d(r),"lon and lat must be numbers"),t>=72.004&&t<=137.8347&&r>=.8293&&r<=55.8271}var j=Math.sin,w=Math.cos,J=Math.atan2,k=Math.sqrt,D=3e3*Math.PI/180;function I(t){var r=b(t,2),e=r[0]-.0065,n=r[1]-.006,o=k(e*e+n*n)-2e-5*j(n*D),i=J(n,e)-3e-6*w(e*D);return[o*w(i),o*j(i)]}function q(t){var r=b(t,2),e=r[0],n=r[1],o=k(e*e+n*n)+2e-5*j(n*D),i=J(n,e)+3e-6*w(e*D);return[o*w(i)+.0065,o*j(i)+.006]}var O=180/Math.PI,x=Math.PI/180,A=6378137,L=20037508.342789244;function N(t){return[t[0]*O/A,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/A)))*O]}function F(t){var r=Math.abs(t[0])<=180?t[0]:t[0]-360*(t[0]<0?-1:1),e=[A*r*x,A*Math.log(Math.tan(.25*Math.PI+.5*t[1]*x))];return e[0]>L&&(e[0]=L),e[0]<-L&&(e[0]=-L),e[1]>L&&(e[1]=L),e[1]<-L&&(e[1]=-L),e}var T={to:{GCJ02:W,BD09:h(q,W),EPSG3857:F}},_={to:{WGS84:B,BD09:q,EPSG3857:h(F,B)}},z={to:{WGS84:h(B,I),GCJ02:I,EPSG3857:h(F,B,I)}},U={to:{WGS84:N,GCJ02:h(W,N),BD09:h(q,W,N)}},H=(Object.freeze||Object)({WGS84:T,GCJ02:_,BD09:z,EPSG3857:U});function K(t,r,e){y(!t,"coordinate is required"),y(!r,"original coordinate system is required"),y(!e,"target coordinate system is required");var n=H[r];if(y(!n,"original coordinate system is invalid"),r===e)return t;var o=n.to[e];y(!o,"target coordinate system is invalid");var i=void 0===t?"undefined":g(t);y("string"!==i&&"object"!==i,"coordinate must be an geojson or an array of position"),"string"===i&&(t=JSON.parse(t));var a=!1;v(t)&&(y(t.length<2,"position must be at 2 numbers long"),y(!d(t[0])||!d(t[1]),"position must contain numbers"),a=!0);var u=null,l=o;return a?u=l(t):(!function t(r,e,n){if(null!==r)for(var o=void 0,i=void 0,a=void 0,u=void 0,l=void 0,f=void 0,s=void 0,c=0,y=0,d=void 0,v=r.type,h="FeatureCollection"===v,g="Feature"===v,b=h?r.features.length:1,m=0;m<b;m++){l=(d=!!(s=h?r.features[m].geometry:g?r.geometry:r)&&"GeometryCollection"===s.type)?s.geometries.length:1;for(var p=0;p<l;p++){var S=0,M=0;if(null!==(u=d?s.geometries[p]:s)){f=u.coordinates;var G=u.type;switch(c=!n||"Polygon"!==G&&"MultiPolygon"!==G?0:1,G){case null:break;case"Point":if(!1===e(f,y,m,S,M))return!1;y++,S++;break;case"LineString":case"MultiPoint":for(o=0;o<f.length;o++){if(!1===e(f[o],y,m,S,M))return!1;y++,"MultiPoint"===G&&S++}"LineString"===G&&S++;break;case"Polygon":case"MultiLineString":for(o=0;o<f.length;o++){for(i=0;i<f[o].length-c;i++){if(!1===e(f[o][i],y,m,S,M))return!1;y++}"MultiLineString"===G&&S++,"Polygon"===G&&M++}"Polygon"===G&&S++;break;case"MultiPolygon":for(o=0;o<f.length;o++){for(M=0,i=0;i<f[o].length;i++){for(a=0;a<f[o][i].length-c;a++){if(!1===e(f[o][i][a],y,m,S,M))return!1;y++}M++}S++}break;case"GeometryCollection":for(o=0;o<u.geometries.length;o++)if(!1===t(u.geometries[o],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}(t,function(t){var r=l(t);t[0]=r[0],t[1]=r[1]}),u=t),u}var Q={WGS84:r,WGS1984:e,GCJ02:n,BD09:o,EPSG4326:i,EPSG3857:a,EPSG900913:u,Baidu:l,BMap:f,AMap:s,WebMercator:c,transform:K};t.WGS84=r,t.WGS1984=e,t.GCJ02=n,t.BD09=o,t.EPSG4326=i,t.EPSG3857=a,t.EPSG900913=u,t.Baidu=l,t.BMap=f,t.AMap=s,t.WebMercator=c,t.transform=K,t.default=Q,Object.defineProperty(t,"__esModule",{value:!0})});